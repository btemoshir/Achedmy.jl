<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · Achedmy.jl</title><meta name="title" content="API Reference · Achedmy.jl"/><meta property="og:title" content="API Reference · Achedmy.jl"/><meta property="twitter:title" content="API Reference · Achedmy.jl"/><meta name="description" content="Documentation for Achedmy.jl."/><meta property="og:description" content="Documentation for Achedmy.jl."/><meta property="twitter:description" content="Documentation for Achedmy.jl."/><meta property="og:url" content="https://btemoshir.github.io/Achedmy.jl/api/"/><meta property="twitter:url" content="https://btemoshir.github.io/Achedmy.jl/api/"/><link rel="canonical" href="https://btemoshir.github.io/Achedmy.jl/api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Achedmy.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Achedmy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../tutorial/">Getting Started</a></li><li><a class="tocitem" href="../theory/">Theory</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>API Reference</a><ul class="internal"><li><a class="tocitem" href="#Main-Types"><span>Main Types</span></a></li><li><a class="tocitem" href="#Main-Functions"><span>Main Functions</span></a></li><li><a class="tocitem" href="#Symmetry-Types"><span>Symmetry Types</span></a></li><li><a class="tocitem" href="#Internal-Functions"><span>Internal Functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/btemoshir/Achedmy.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/btemoshir/Achedmy.jl/blob/main/docs/src/api.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="Achedmy.Achedmy"><a class="docstring-binding" href="#Achedmy.Achedmy"><code>Achedmy.Achedmy</code></a> — <span class="docstring-category">Module</span></summary><section><div><pre><code class="language-julia hljs">Achedmy</code></pre><p>Adaptive CHEmical Dynamics using MemorY</p><p>A Julia package for computing memory-corrected dynamics of chemical reaction networks (CRNs)  with discrete molecular number fluctuations using dynamical free energy and Plefka expansions.</p><p><strong>Approximation Methods</strong></p><ul><li><strong>gSBR</strong>: Generalized self-consistent bubble resummation (recommended)</li><li><strong>SBR</strong>: Self-consistent bubble resummation (ignores the joint fluctuations induced by different reactions)</li><li><strong>MCA</strong>: Mode coupling approximation (O(α^2))</li><li><strong>MAK</strong>: Mass action kinetics (mean-field)</li></ul><p><strong>Main Types</strong></p><ul><li><a href="#Achedmy.ReactionStructure"><code>ReactionStructure</code></a>: Stores reaction network stoichiometry and rates</li><li><a href="#Achedmy.ReactionVariables"><code>ReactionVariables</code></a>: Stores dynamical variables (means, correlations, responses, self-energies)</li></ul><p><strong>Main Functions</strong></p><ul><li><a href="#Achedmy.solve_dynamics!"><code>solve_dynamics!</code></a>: Integrate the memory-corrected equations</li><li><a href="#Achedmy.ReactionStructure"><code>ReactionStructure</code></a>: Constructor from Catalyst networks</li><li><a href="#Achedmy.ReactionVariables"><code>ReactionVariables</code></a>: Initialize variables container</li></ul><p><strong>Quick Example</strong></p><pre><code class="language-julia hljs">using Achedmy, Catalyst

# Define reaction network
rn = @reaction_network begin
    @species S(t)=1.0 P(t)=0.1
    @parameters k=1.0 d=0.1
    k, S --&gt; S + P
    d, P --&gt; 0
end

# Setup and solve
structure = ReactionStructure(rn)
variables = ReactionVariables(structure, &quot;cross&quot;)
sol = solve_dynamics!(structure, variables, 
                     selfEnergy=&quot;gSBR&quot;, tmax=10.0)

# Extract results
mean_P = variables.μ[2, :]  # Mean protein count
variance_P = diag(variables.N[2,2,:,:])  # Variance over time</code></pre><p><strong>Citation</strong></p><p>If you use Achedmy.jl in your research, please cite:</p><p>Harsh, M. (2025). Memory-corrected dynamics of chemical reaction networks  via Plefka expansion. In preparation.</p><p><strong>See Also</strong></p><ul><li><a href="https://github.com/btemoshir/achedmy">GitHub Repository</a></li><li><a href="https://docs.sciml.ai/Catalyst/stable/">Catalyst.jl</a></li><li><a href="https://nonequilibriumdynamics.github.io/KadanoffBaym.jl/">KadanoffBaym.jl</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/btemoshir/Achedmy.jl/blob/d5b35eecf4354ed60db946e7f7f3fe0da001c405/src/Achedmy.jl#L1-L63">source</a></section></details></article><p>This page documents all public functions and types in Achedmy.jl.</p><h2 id="Main-Types"><a class="docs-heading-anchor" href="#Main-Types">Main Types</a><a id="Main-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Types" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Achedmy.ReactionStructure"><a class="docstring-binding" href="#Achedmy.ReactionStructure"><code>Achedmy.ReactionStructure</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ReactionStructure</code></pre><p>Stores the stoichiometry and rate information for a chemical reaction network.</p><p><strong>Fields</strong></p><ul><li><code>num_species::Int</code>: Number of chemical species in the network</li><li><code>num_interactions::Int</code>: Number of interaction reactions (non-baseline reactions or reactions other than simple creation/destruction)</li><li><code>num_reactions::Int</code>: Total number of reactions (creation + destruction + interactions)</li><li><code>rate_creation::Vector{Float64}</code>: Rate constants for spontaneous creation reactions</li><li><code>rate_destruction::Vector{Float64}</code>: Rate constants for destruction reactions</li><li><code>rate_interaction::Vector{Float64}</code>: Rate constants for interaction reactions</li><li><code>stochiometry_prod::Matrix{Int}</code>: Stoichiometry matrix for products for each <code>interaction</code> reaction</li><li><code>stochiometry_react::Matrix{Int}</code>: Stoichiometry matrix for reactants for each <code>interaction</code> reaction</li><li><code>initial_values::Vector{Float64}</code>: Initial molecular counts for each species</li><li><code>n_list</code>: List of reaction vectors for generating combinatorial structures</li><li><code>n_list_union</code>: Union of all reaction vectors</li><li><code>m_list</code>: List of auxiliary reaction vectors</li><li><code>m_list_union</code>: Union of auxiliary reaction vectors</li><li><code>initial_C::Union{Vector{Float64}, Matrix{Float64}}</code>: Initial correlations C(0,0) - can be a vector for single-species or matrix for inter-species correlations</li></ul><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">ReactionStructure(reaction_system::ReactionSystem; 
                 external_initialization=false,
                 initial_correlations=false)</code></pre><p>Create a <code>ReactionStructure</code> from a Catalyst <code>ReactionSystem</code>.</p><p><strong>Arguments</strong></p><ul><li><code>reaction_system::ReactionSystem</code>: Catalyst reaction network</li><li><code>external_initialization::Union{Dict,Bool}=false</code>: External rates/values not in Catalyst define <code>reaction_system</code></li><li><code>initial_correlations::Union{Vector,Matrix,Bool}=false</code>: Initial correlation values C(0,0)<ul><li><code>Vector</code>: For single-species correlations (size: num_species)</li><li><code>Matrix</code>: For cross-species correlations (size: num<em>species × num</em>species)</li><li><code>false</code>: Zero initial correlations (default)</li></ul></li></ul><p>Reactions are categorized as:</p><ol><li><strong>Creation</strong>: ∅ → A (rate: k₁)</li><li><strong>Destruction</strong>: A → ∅ (rate: k₂)</li><li><strong>Interactions</strong>: A + B → C (rate: k₃)</li></ol><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Catalyst, Achedmy

# Define gene regulation network
gene_network = @reaction_network begin
    @species G(t)=0.01 P(t)=10.0
    @parameters k_on=0.1 k_off=1.0 k_p=10.0 k_d=1.0
    (k_on, k_off), 0 &lt;--&gt; G
    k_p, G --&gt; G + P
    k_d, P --&gt; 0
end

# Create structure
structure = ReactionStructure(gene_network)
println(&quot;Number of species: &quot;, structure.num_species)
println(&quot;Initial protein count: &quot;, structure.initial_values[2])
println(&quot;Creation rates: &quot;, structure.rate_creation)</code></pre><p><strong>Notes</strong></p><ul><li>Non-zero initial correlations are currently not supported but planned for future versions</li><li>Species order is determined by the order in the <code>ReactionSystem</code></li><li>External initialization is useful for parameter sweeps</li></ul><p><strong>See Also</strong></p><ul><li><a href="#Achedmy.ReactionVariables"><code>ReactionVariables</code></a>: Storage for dynamical variables</li><li><a href="#Achedmy.solve_dynamics!"><code>solve_dynamics!</code></a>: Solve the dynamics</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/btemoshir/Achedmy.jl/blob/d5b35eecf4354ed60db946e7f7f3fe0da001c405/src/Struct.jl#L1-L76">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Achedmy.ReactionVariables"><a class="docstring-binding" href="#Achedmy.ReactionVariables"><code>Achedmy.ReactionVariables</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ReactionVariables</code></pre><p>Storage container for all dynamical variables computed during the simulation.</p><p><strong>Fields</strong></p><ul><li><code>response_type::String</code>: Either &quot;single&quot; (diagonal only) or &quot;cross&quot; (full matrix)</li><li><code>μ::GreenFunction</code>: Mean molecular numbers, <span>$\langle n_i(t) \rangle$</span><ul><li>Size: <code>(num_species, num_timesteps)</code></li></ul></li><li><code>R::GreenFunction</code>: Response function, <span>$R_{ij}(t,t&#39;)$</span><ul><li><strong>Single</strong>: Size <code>(num_species, num_timesteps, num_timesteps)</code></li><li><strong>Cross</strong>: Size <code>(num_species, num_species, num_timesteps, num_timesteps)</code></li><li>Measures response to perturbations</li><li>Causal: <span>$R_{ij}(t,t&#39;) = 0$</span> for <span>$t &lt; t&#39;$</span></li></ul></li><li><code>C::GreenFunction</code>: Connected correlation function, <span>$C_{ij}(t,t&#39;)$</span><ul><li>Same dimensions as <code>R</code></li><li><p class="math-container">\[C_{ij}(t,t&#39;) = \langle \delta \phi_i(t) \delta \phi_j(t&#39;) \rangle_c\]</p></li></ul></li><li><code>N::GreenFunction</code>: Number-number correlator, <span>$N_{ij}(t,t&#39;)$</span><ul><li>Same dimensions as <code>R</code></li><li><p class="math-container">\[N_{ij}(t,t&#39;) = \langle \delta n_i(t) \delta n_j(t&#39;) \rangle\]</p></li><li>Related to C by: <span>$N = C + R \otimes \mu$</span></li></ul></li><li><code>Σ_R::GreenFunction</code>: Response self-energy (memory kernel)</li><li><code>Σ_μ::GreenFunction</code>: Mean self-energy (memory kernel)</li><li><code>Σ_B::GreenFunction</code>: Correlation self-energy (memory kernel)</li></ul><p><strong>Response Types</strong></p><p><strong>&quot;single&quot; Mode</strong></p><ul><li>Tracks only diagonal elements (single-species correlations)</li><li>Memory usage: O(N × T^n) where N = num<em>species, T = num</em>timesteps, n = depends on the approximation used</li><li>Faster for large systems with weak cross-correlations</li></ul><p><strong>&quot;cross&quot; Mode</strong></p><ul><li>Tracks full matrix (all cross-species correlations)</li><li>Memory usage: O(N² × T^n) where N = num<em>species, T = num</em>timesteps, n = depends on the approximation used</li><li>More accurate, captures all correlations</li></ul><p><strong>Constructor</strong></p><pre><code class="nohighlight hljs">ReactionVariables(structure::ReactionStructure, response_type::String=&quot;cross&quot;)</code></pre><p>Initialize storage arrays for dynamics computation.</p><p><strong>Arguments</strong></p><ul><li><code>structure::ReactionStructure</code>: Reaction network structure</li><li><code>response_type::String</code>: Either &quot;cross&quot; (default) or &quot;single&quot;</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Achedmy, Catalyst

enzyme = @reaction_network begin
    @species S(t)=1.0 E(t)=0.9 C(t)=0.1 P(t)=0.0
    @parameters k_f=1.0 k_b=0.1 k_cat=1.0
    (k_f, k_b), S + E &lt;--&gt; C
    k_cat, C --&gt; E + P
end

structure = ReactionStructure(enzyme)

# Full cross-correlations (recommended)
vars_cross = ReactionVariables(structure, &quot;cross&quot;)
sol_cross = solve_dynamics!(structure, vars_cross, selfEnergy=&quot;gSBR&quot;, tmax=5.0)

# Single-species only (memory efficient)
vars_single = ReactionVariables(structure, &quot;single&quot;)
sol_single = solve_dynamics!(structure, vars_single, selfEnergy=&quot;gSBR&quot;, tmax=5.0)

# Access results
mean_substrate = vars_cross.μ[1, :]              # Mean S(t)
variance_product = diag(vars_cross.N[4,4,:,:])  # Var(P) over time
response_SE = vars_cross.R[1,2,:,:]              # R_SE(t,t&#39;)
cross_corr_SP = vars_cross.N[1,4,:,:]            # ⟨δS(t)δP(t&#39;)⟩</code></pre><p><strong>Performance Tips</strong></p><ul><li>Use <code>&quot;single&quot;</code> for systems with &gt;10 species to save memory</li><li>For weakly coupled systems, <code>&quot;single&quot;</code> may be sufficient</li></ul><p><strong>See Also</strong></p><ul><li><a href="#Achedmy.ReactionStructure"><code>ReactionStructure</code></a></li><li><a href="#Achedmy.solve_dynamics!"><code>solve_dynamics!</code></a></li><li><a href="#Achedmy.Response"><code>Response</code></a>: Symmetry types</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/btemoshir/Achedmy.jl/blob/d5b35eecf4354ed60db946e7f7f3fe0da001c405/src/Var.jl#L51-L143">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Achedmy.Response"><a class="docstring-binding" href="#Achedmy.Response"><code>Achedmy.Response</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Response</code></pre><p>Defined as  <span>$G(t,t&#39;) = 0 if t&#39; &gt; t$</span></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/btemoshir/Achedmy.jl/blob/d5b35eecf4354ed60db946e7f7f3fe0da001c405/src/Var.jl#L1-L6">source</a></section></details></article><h2 id="Main-Functions"><a class="docs-heading-anchor" href="#Main-Functions">Main Functions</a><a id="Main-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Functions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="Achedmy.solve_dynamics!"><a class="docstring-binding" href="#Achedmy.solve_dynamics!"><code>Achedmy.solve_dynamics!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">solve_dynamics!(structure, variables; kwargs...)</code></pre><p>Solve the memory-corrected dynamics for a chemical reaction network.</p><p><strong>Arguments</strong></p><ul><li><code>structure::ReactionStructure</code>: Reaction network structure with stoichiometry and rates</li><li><code>variables::ReactionVariables</code>: Storage container for dynamical variables (modified in-place)</li></ul><p><strong>Approximation Method</strong></p><ul><li><code>selfEnergy::String = &quot;gSBR&quot;</code>: Self-energy approximation scheme<ul><li><code>&quot;gSBR&quot;</code>: Generalized self-consistent bubble resummation <strong>Recommended</strong></li><li><code>&quot;SBR&quot;</code>: Self-consistent bubble resummation (single-species only, ignores the joint fluctuations induced by different reactions)</li><li><code>&quot;MCA&quot;</code>: Mode coupling approximation (perturbative to O(α²))</li><li><code>&quot;MAK&quot;</code>: Mass action kinetics (mean-field, no memory)</li></ul></li></ul><p><strong>Time Parameters</strong></p><ul><li><code>tstart::Float64 = 0.0</code>: Initial time</li><li><code>tmax::Float64 = 1.0</code>: Final simulation time</li></ul><p><strong>Solver Tolerances</strong></p><ul><li><code>atol::Float64 = 1e-3</code>: Absolute tolerance for adaptive solver</li><li><code>rtol::Float64 = 1e-2</code>: Relative tolerance for adaptive solver</li></ul><p><strong>Advanced Solver Parameters</strong></p><ul><li><code>k_max::Int = 12</code>: Maximum interpolation order</li><li><code>dtini::Float64 = 0.0</code>: Initial time step (0 = auto)</li><li><code>dtmax::Float64 = Inf</code>: Maximum time step</li><li><code>qmax::Float64 = 5</code>: Maximum step size growth factor</li><li><code>qmin::Float64 = 1//5</code>: Minimum step size shrink factor</li><li><code>γ::Float64 = 9//10</code>: Safety factor for step size adaptation</li><li><code>kmax_vie::Int = k_max ÷ 2</code>: Maximum order for Volterra integral equations</li></ul><p><strong>Returns</strong></p><ul><li><code>sol</code>: Solution object from <code>kbsolve!</code> with fields:<ul><li><code>t::Vector{Float64}</code>: Adaptive time grid</li><li><code>w::Vector{Vector{Float64}}</code>: Integration weights at each time step</li><li><code>retcode::Symbol</code>: Solution status (<code>:Success</code> if converged)</li></ul></li></ul><p><strong>Side Effects</strong></p><p>The <code>variables</code> object is modified in-place with computed values:</p><ul><li><code>variables.μ</code>: Mean trajectories</li><li><code>variables.R</code>: Response functions</li><li><code>variables.C</code>: Correlation functions</li><li><code>variables.N</code>: Number-number correlators</li><li><code>variables.Σ_R</code>, <code>variables.Σ_μ</code>, <code>variables.Σ_B</code>: Self-energies</li></ul><p><strong>Algorithm</strong></p><p>Solves coupled integro-differential Kadanoff-Baym equations:</p><p class="math-container">\[\begin{aligned}
\partial_t \mu_i(t) &amp;= k_{1i} - k_{2i} \mu_i(t) + \Sigma_\mu^{i}(t) \\
(\partial_t &amp;+ k_{2i}) R_{ij}(t,t&#39;) &amp;= \delta(t-t&#39;) \delta_{ij} + \int_{t&#39;}^{t} d\tau&#39;&#39; \, \sum_k \Sigma_R^{ik}(t,\tau&#39;&#39;) R_{kj}(\tau&#39;&#39;,t&#39;)
\end{aligned}\]</p><p>where self-energies <span>$\Sigma$</span> are computed according to the chosen approximation method.</p><p><strong>Approximation Methods Explained</strong></p><p><strong>gSBR (Generalized Self-consistent Bubble Resummation) ⭐</strong></p><ul><li><strong>Accuracy</strong>: Best available, validated against numerical solutions of the master equation</li><li><strong>Includes</strong>: All cross-species and cross-reaction corrections and full memory effects</li><li><strong>Use when</strong>: Accuracy is critical, small molecule numbers</li><li><strong>Works with</strong>: Both &quot;single&quot; and &quot;cross&quot; response types</li></ul><p><strong>SBR (Self-consistent Bubble Resummation)</strong></p><ul><li><strong>Accuracy</strong>: Good for weakly coupled systems</li><li><strong>Includes</strong>: Only diagonal self-energies, no cross-species nor cross-reaction memory corrections</li><li><strong>Use when</strong>: Species are weakly coupled</li><li><strong>Restriction</strong>: Only works with &quot;single&quot; response type</li></ul><p><strong>MCA (Mode Coupling Approximation)</strong></p><ul><li><strong>Accuracy</strong>: Perturbative O(α²) correction to MAK</li><li><strong>Includes</strong>: Leading-order fluctuation corrections</li><li><strong>Use when</strong>: Fluctuations are weak</li><li><strong>Unstable</strong>: May lead to numerical instabilities in most cases with large reaction rates</li><li><strong>Works with</strong>: Both &quot;single&quot; and &quot;cross&quot; response types</li></ul><p><strong>MAK (Mass Action Kinetics)</strong></p><ul><li><strong>Accuracy</strong>: Mean-field only, no fluctuations</li><li><strong>Includes</strong>: No memory effects</li><li><strong>Use when</strong>: Quick baseline comparison needed</li><li><strong>Limitation</strong>: Fails for small molecule counts</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Achedmy, Catalyst

# Define Michaelis-Menten enzyme kinetics
enzyme = @reaction_network begin
    @species S(t)=1.0 E(t)=0.9 C(t)=0.1 P(t)=0.0
    @parameters k_f=1.0 k_b=0.1 k_cat=1.0
    (k_f, k_b), S + E &lt;--&gt; C
    k_cat, C --&gt; E + P
end

# Setup
structure = ReactionStructure(enzyme)
variables = ReactionVariables(structure, &quot;cross&quot;)

# Solve with high accuracy
sol = solve_dynamics!(
    structure, 
    variables,
    selfEnergy = &quot;gSBR&quot;,
    tmax = 5.0,
    tstart = 0.0,
    atol = 1e-4,
    rtol = 1e-3
)

# Check convergence
@assert sol.retcode == :Success &quot;Solver did not converge!&quot;

# Extract results
time = sol.t
mean_product = variables.μ[4, :]  # P(t)
variance_product = diag(variables.N[4,4,:,:])  # Var[P(t)]
response_SE = variables.R[1,2,:,:]  # How E responds to perturbation in S

# Visualize
using PyPlot
figure(figsize=(10,4))
subplot(121)
plot(time, mean_product)
xlabel(&quot;Time&quot;)
ylabel(&quot;⟨P(t)⟩&quot;)

subplot(122)
plot(time, variance_product)
xlabel(&quot;Time&quot;)
ylabel(&quot;Var[P(t)]&quot;)</code></pre><p><strong>Performance Tips</strong></p><ol><li><strong>Start loose, tighten if needed</strong>: Begin with <code>atol=1e-3</code>, <code>rtol=1e-2</code></li><li><strong>Time range</strong>: Longer <code>tmax</code> increases cost quadratically or cubically due to memory integrals</li><li><strong>Method selection</strong>:<ul><li>Production runs: <code>gSBR</code> with <code>&quot;cross&quot;</code></li><li>Large systems (&gt;10 species): <code>gSBR</code> with <code>&quot;single&quot;</code></li><li>Quick tests: <code>MAK</code> or <code>MCA</code></li></ul></li><li><strong>Tolerance tuning</strong>: If variances go negative, decrease tolerances</li></ol><p><strong>Common Issues</strong></p><p><strong>Negative Variances</strong></p><p><strong>Problem</strong>: <code>diag(variables.N[i,i,:,:])</code> contains negative values</p><p><strong>Solutions</strong>:</p><ul><li>Decrease <code>atol</code> and <code>rtol</code> (e.g., <code>1e-5</code>)</li><li>Use <code>&quot;cross&quot;</code> response type instead of <code>&quot;single&quot;</code></li><li>Reduce <code>tmax</code> or increase <code>dtmax</code> to limit time range</li><li>Check that initial conditions are physical (non-negative)</li></ul><p><strong>Slow Convergence</strong></p><p><strong>Problem</strong>: Simulation takes too long</p><p><strong>Solutions</strong>:</p><ul><li>Increase tolerances to <code>atol=1e-2</code>, <code>rtol=1e-1</code></li><li>Switch from <code>&quot;cross&quot;</code> to <code>&quot;single&quot;</code> response type</li><li>Use <code>SBR</code> or <code>MCA</code> instead of <code>gSBR</code></li><li>Reduce <code>tmax</code> or limit time range</li></ul><p><strong>SBR with cross response error</strong></p><p><strong>Problem</strong>: Error when using <code>selfEnergy=&quot;SBR&quot;</code> with <code>response_type=&quot;cross&quot;</code></p><p><strong>Solution</strong>: Use <code>selfEnergy=&quot;gSBR&quot;</code> or change to <code>response_type=&quot;single&quot;</code></p><p><strong>See Also</strong></p><ul><li><a href="#Achedmy.ReactionStructure"><code>ReactionStructure</code></a>: Define reaction networks</li><li><a href="#Achedmy.ReactionVariables"><code>ReactionVariables</code></a>: Storage container</li><li><a href="https://nonequilibriumdynamics.github.io/KadanoffBaym.jl/">KadanoffBaym.jl</a>: Underlying solver</li><li><a href="https://docs.sciml.ai/Catalyst/stable/">Catalyst.jl</a>: Reaction network DSL</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/btemoshir/Achedmy.jl/blob/d5b35eecf4354ed60db946e7f7f3fe0da001c405/src/Dynamics.jl#L3-L185">source</a></section></details></article><h2 id="Symmetry-Types"><a class="docs-heading-anchor" href="#Symmetry-Types">Symmetry Types</a><a id="Symmetry-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Symmetry-Types" title="Permalink"></a></h2><p>Beyond <code>Response</code>, Achedmy defines additional symmetry types for Green&#39;s functions:</p><ul><li><strong><code>Correlation</code></strong>: Enforces block symmetry for cross-species correlations</li><li><strong><code>OnePoint</code></strong>: For mean-field (one-point) functions</li></ul><p>See the source code in <a href="https://github.com/btemoshir/Achedmy.jl/blob/main/src/Var.jl"><code>src/Var.jl</code></a> for implementation details.</p><h2 id="Internal-Functions"><a class="docs-heading-anchor" href="#Internal-Functions">Internal Functions</a><a id="Internal-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-Functions" title="Permalink"></a></h2><p>The following internal functions have detailed docstrings in the source code but are not part of the public API:</p><h3 id="Self-Energy-Functions-([src/SelfEnergy.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/SelfEnergy.jl))"><a class="docs-heading-anchor" href="#Self-Energy-Functions-([src/SelfEnergy.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/SelfEnergy.jl))">Self-Energy Functions (<a href="https://github.com/btemoshir/Achedmy.jl/blob/main/src/SelfEnergy.jl"><code>src/SelfEnergy.jl</code></a>)</a><a id="Self-Energy-Functions-([src/SelfEnergy.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/SelfEnergy.jl))-1"></a><a class="docs-heading-anchor-permalink" href="#Self-Energy-Functions-([src/SelfEnergy.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/SelfEnergy.jl))" title="Permalink"></a></h3><ul><li><code>self_energy_mak_noC!</code> - MAK approximation without correlations</li><li><code>self_energy_alpha2!</code> - α² expansion self-energy</li><li><code>self_energy_SBR!</code> - Single-species SBR approximation</li><li><code>self_energy_SBR_mixed!</code> - Mixed SBR for multiple species</li><li><code>self_energy_SBR_mixed_cross_noC!</code> - Cross-species SBR without initial correlations</li><li><code>self_energy_alpha2_cross!</code> - Cross-species α² expansion</li></ul><h3 id="Coefficient-Functions-([src/Cmn.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/Cmn.jl))"><a class="docs-heading-anchor" href="#Coefficient-Functions-([src/Cmn.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/Cmn.jl))">Coefficient Functions (<a href="https://github.com/btemoshir/Achedmy.jl/blob/main/src/Cmn.jl"><code>src/Cmn.jl</code></a>)</a><a id="Coefficient-Functions-([src/Cmn.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/Cmn.jl))-1"></a><a class="docs-heading-anchor-permalink" href="#Coefficient-Functions-([src/Cmn.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/Cmn.jl))" title="Permalink"></a></h3><ul><li><code>mnList</code> - Generate (m,n) index pairs</li><li><code>c_mn_no_mu</code> - Coefficient calculation without mean-field</li><li><code>c_mn</code> - Full coefficient with mean-field</li><li><code>c_mnFULL</code> - Complete coefficient matrix</li><li><code>c_mnFULL_test</code> - Test version with validation</li><li><code>create_c_mn_dict</code> - Dictionary of coefficients</li></ul><h3 id="Block-Operations-([src/BlockOp.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/BlockOp.jl))"><a class="docs-heading-anchor" href="#Block-Operations-([src/BlockOp.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/BlockOp.jl))">Block Operations (<a href="https://github.com/btemoshir/Achedmy.jl/blob/main/src/BlockOp.jl"><code>src/BlockOp.jl</code></a>)</a><a id="Block-Operations-([src/BlockOp.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/BlockOp.jl))-1"></a><a class="docs-heading-anchor-permalink" href="#Block-Operations-([src/BlockOp.jl](https://github.com/btemoshir/Achedmy.jl/blob/main/src/BlockOp.jl))" title="Permalink"></a></h3><ul><li><code>block_tri_lower_inverse</code> - Inverse of block lower-triangular matrix</li><li><code>block_mat_mul</code> - Block matrix multiplication</li><li><code>block_mat_mix_mul</code> - Mixed block multiplication</li><li><code>block_lower_shift</code> - Shift operation for block matrices</li><li><code>block_identity</code> - Block identity matrix</li><li><code>block_vec_mat_mul_single_sp</code> - Vector-matrix product for single species</li><li><code>response_combinations</code> - Generate response function index combinations</li></ul><p>For detailed mathematical descriptions and usage examples, see the comprehensive docstrings in each source file.</p><p>See the <a href="https://github.com/btemoshir/Achedmy.jl">source code</a> for detailed docstrings of internal functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 18 January 2026 09:33">Sunday 18 January 2026</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
